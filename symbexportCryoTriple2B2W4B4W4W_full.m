qm = [...
kbuz-((-1+c1^2)*g*(m1+m2+m3))/(2*c1*l1)+(c1^2*kw1*l1^2)/(c1^2*l1^2+(n0-n1)^2) 0 0 0 0 0
 0 kbuz-((-1+c1^2)*g*(m1+m2+m3))/(2*c1*l1)+(c1^2*kw1*l1^2)/(c1^2*l1^2+(n0-n1)^2) 0 0 0 0
 0 0 kblz-((-1+c2^2)*g*(m2+m3))/(4*c2*l2)+(c2^2*kw2*l2^2)/(c2^2*l2^2+(n2-n3)^2) 0 0 0
 0 0 0 kblz-((-1+c2^2)*g*(m2+m3))/(4*c2*l2)+(c2^2*kw2*l2^2)/(c2^2*l2^2+(n2-n3)^2) 0 0
 0 0 0 0 kblz-((-1+c2^2)*g*(m2+m3))/(4*c2*l2)+(c2^2*kw2*l2^2)/(c2^2*l2^2+(n2-n3)^2) 0
 0 0 0 0 0 kblz-((-1+c2^2)*g*(m2+m3))/(4*c2*l2)+(c2^2*kw2*l2^2)/(c2^2*l2^2+(n2-n3)^2)
];
cqsm = [...
0 ((g*(m1+m2+m3)-(2*c1*kw1*l1^3)/(c1^2*l1^2+(n0-n1)^2))*(-n0+n1))/(2*l1^2) -1/2*((-1+c1^2)*g*(m1+m2+m3))/(c1*l1)+(c1^2*kw1*l1^2)/(c1^2*l1^2+(n0-n1)^2) 0 0 (-2*g*(m1+m2+m3)*(c1*l1*n0+dtop*(n0-n1))+(4*c1*kw1*l1^3*(c1*l1*n0+dtop*(n0-n1)))/(c1^2*l1^2+(n0-n1)^2)+(2*g*l1*(m1+m2+m3)*n1)/c1)/(4*l1^2)
 0 ((g*(m1+m2+m3)-(2*c1*kw1*l1^3)/(c1^2*l1^2+(n0-n1)^2))*(n0-n1))/(2*l1^2) -1/2*((-1+c1^2)*g*(m1+m2+m3))/(c1*l1)+(c1^2*kw1*l1^2)/(c1^2*l1^2+(n0-n1)^2) 0 0 (2*g*(m1+m2+m3)*(c1*l1*n0+dtop*(n0-n1))-(4*c1*kw1*l1^3*(c1*l1*n0+dtop*(n0-n1)))/(c1^2*l1^2+(n0-n1)^2)-(2*g*l1*(m1+m2+m3)*n1)/c1)/(4*l1^2)
 0 0 0 0 0 0
 0 0 0 0 0 0
 0 0 0 0 0 0
 0 0 0 0 0 0
];
xm = [...
(g*(m2+m3))/(c2*l2)+(g*(m1+m2+m3))/(c1*l1) 0 0 0 -((d1*g*(m2+m3))/(c2*l2))+(d0*g*(m1+m2+m3))/(c1*l1) 0 -((g*(m2+m3))/(c2*l2)) 0 0 0 -((d2*g*(m2+m3))/(c2*l2)) 0 0 0 0 0 0 0
 0 (g*(m2+m3))/(c2*l2)+(g*(m1+m2+m3))/(c1*l1)-(g*(m1+m2+m3)*(n0-n1)^2)/(c1*l1^3)+(2*kw1*(n0-n1)^2)/(c1^2*l1^2+(n0-n1)^2)-(g*(m2+m3)*(n2-n3)^2)/(c2*l2^3)+(4*kw2*(n2-n3)^2)/(c2^2*l2^2+(n2-n3)^2) 0 0 0 (d1*g*(m2+m3))/(c2*l2)-(d0*g*(m1+m2+m3))/(c1*l1)-(g*(m1+m2+m3)*(n0-n1)*(c1*l1*n1+d0*(-n0+n1)))/(c1*l1^3)+(2*kw1*(n0-n1)*(c1*l1*n1+d0*(-n0+n1)))/(c1^2*l1^2+(n0-n1)^2)-(g*(m2+m3)*(c2*l2*n2+d1*(n2-n3))*(n2-n3))/(c2*l2^3)+(4*kw2*(c2*l2*n2+d1*(n2-n3))*(n2-n3))/(c2^2*l2^2+(n2-n3)^2) 0 -((g*(m2+m3))/(c2*l2))+(g*(m2+m3)*(n2-n3)^2)/(c2*l2^3)-(4*kw2*(n2-n3)^2)/(c2^2*l2^2+(n2-n3)^2) 0 0 0 (d2*g*(m2+m3))/(c2*l2)+(g*(m2+m3)*(n2-n3)*(c2*l2*n3+d2*(-n2+n3)))/(c2*l2^3)-(4*kw2*(n2-n3)*(c2*l2*n3+d2*(-n2+n3)))/(c2^2*l2^2+(n2-n3)^2) 0 0 0 0 0 0
 0 0 -(((-1+c2^2)*g*(m2+m3))/(c2*l2))+(g*(m1+m2+m3))/(c1*l1)-(c1*g*(m1+m2+m3))/l1+(2*c1^2*kw1*l1^2)/(c1^2*l1^2+(n0-n1)^2)+(4*c2^2*kw2*l2^2)/(c2^2*l2^2+(n2-n3)^2) 0 0 0 0 0 ((-1+c2^2)*g*(m2+m3))/(c2*l2)-(4*c2^2*kw2*l2^2)/(c2^2*l2^2+(n2-n3)^2) 0 0 0 0 0 0 0 0 0
 0 0 0 (g*(m1+m2+m3)*n0*n1)/(c1*l1)-(g*(m2+m3)*(n2-n3)^2*si^2)/(c2*l2^3)+(4*kw2*(n2-n3)^2*si^2)/(c2^2*l2^2+(n2-n3)^2)+(g*(m2+m3)*(n2*n3+si^2))/(c2*l2) 0 0 0 0 0 (g*(m2+m3)*(n2-n3)^2*si^2)/(c2*l2^3)-(4*kw2*(n2-n3)^2*si^2)/(c2^2*l2^2+(n2-n3)^2)-(g*(m2+m3)*(n2*n3+si^2))/(c2*l2) 0 0 0 0 0 0 0 0
 -((d1*g*(m2+m3))/(c2*l2))+(d0*g*(m1+m2+m3))/(c1*l1) 0 0 0 (d0*g*(d0+c1*l1)*(m1+m2+m3))/(c1*l1)-(c2*g*(m2+m3)*si^2)/l2+(4*c2^2*kw2*l2^2*si^2)/(c2^2*l2^2+(n2-n3)^2)+(g*(m2+m3)*(d1^2+c2*d1*l2+si^2))/(c2*l2) 0 (d1*g*(m2+m3))/(c2*l2) 0 0 0 (d1*d2*g*(m2+m3)+((-1+c2^2)*g*(m2+m3)-(4*c2^3*kw2*l2^3)/(c2^2*l2^2+(n2-n3)^2))*si^2)/(c2*l2) 0 0 0 0 0 0 0
 0 (d1*g*(m2+m3))/(c2*l2)-(d0*g*(m1+m2+m3))/(c1*l1)-(g*(m1+m2+m3)*(n0-n1)*(c1*l1*n1+d0*(-n0+n1)))/(c1*l1^3)+(2*kw1*(n0-n1)*(c1*l1*n1+d0*(-n0+n1)))/(c1^2*l1^2+(n0-n1)^2)-(g*(m2+m3)*(c2*l2*n2+d1*(n2-n3))*(n2-n3))/(c2*l2^3)+(4*kw2*(c2*l2*n2+d1*(n2-n3))*(n2-n3))/(c2^2*l2^2+(n2-n3)^2) 0 0 0 (g*(m1+m2+m3)*(d0^2+c1*d0*l1+n0*n1))/(c1*l1)-(g*(m1+m2+m3)*(c1*l1*n1+d0*(-n0+n1))^2)/(c1*l1^3)+(2*kw1*(c1*l1*n1+d0*(-n0+n1))^2)/(c1^2*l1^2+(n0-n1)^2)-(g*(m2+m3)*(c2*l2*n2+d1*(n2-n3))^2)/(c2*l2^3)+(4*kw2*(c2*l2*n2+d1*(n2-n3))^2)/(c2^2*l2^2+(n2-n3)^2)+(g*(m2+m3)*(d1^2+c2*d1*l2+n2*n3))/(c2*l2) 0 -((d1*g*(m2+m3))/(c2*l2))+(g*(m2+m3)*(c2*l2*n2+d1*(n2-n3))*(n2-n3))/(c2*l2^3)-(4*kw2*(c2*l2*n2+d1*(n2-n3))*(n2-n3))/(c2^2*l2^2+(n2-n3)^2) 0 0 0 (g*(m2+m3)*(d1*d2-n2*n3))/(c2*l2)+(g*(m2+m3)*(c2*l2*n2+d1*(n2-n3))*(c2*l2*n3+d2*(-n2+n3)))/(c2*l2^3)-(4*kw2*(c2*l2*n2+d1*(n2-n3))*(c2*l2*n3+d2*(-n2+n3)))/(c2^2*l2^2+(n2-n3)^2) 0 0 0 0 0 0
 -((g*(m2+m3))/(c2*l2)) 0 0 0 (d1*g*(m2+m3))/(c2*l2) 0 (g*m3)/(c3*l3)+(g*(m2+m3))/(c2*l2) 0 0 0 -((d3*g*m3)/(c3*l3))+(d2*g*(m2+m3))/(c2*l2) 0 -((g*m3)/(c3*l3)) 0 0 0 -((d4*g*m3)/(c3*l3)) 0
 0 -((g*(m2+m3))/(c2*l2))+(g*(m2+m3)*(n2-n3)^2)/(c2*l2^3)-(4*kw2*(n2-n3)^2)/(c2^2*l2^2+(n2-n3)^2) 0 0 0 -((d1*g*(m2+m3))/(c2*l2))+(g*(m2+m3)*(c2*l2*n2+d1*(n2-n3))*(n2-n3))/(c2*l2^3)-(4*kw2*(c2*l2*n2+d1*(n2-n3))*(n2-n3))/(c2^2*l2^2+(n2-n3)^2) 0 (g*m3)/(c3*l3)+(g*(m2+m3))/(c2*l2)-(g*(m2+m3)*(n2-n3)^2)/(c2*l2^3)+(4*kw2*(n2-n3)^2)/(c2^2*l2^2+(n2-n3)^2)-(g*m3*(n4-n5)^2)/(c3*l3^3)+(4*kw3*(n4-n5)^2)/(c3^2*l3^2+(n4-n5)^2) 0 0 0 (d3*g*m3)/(c3*l3)-(d2*g*(m2+m3))/(c2*l2)-(g*(m2+m3)*(n2-n3)*(c2*l2*n3+d2*(-n2+n3)))/(c2*l2^3)+(4*kw2*(n2-n3)*(c2*l2*n3+d2*(-n2+n3)))/(c2^2*l2^2+(n2-n3)^2)-(g*m3*(c3*l3*n4+d3*(n4-n5))*(n4-n5))/(c3*l3^3)+(4*kw3*(c3*l3*n4+d3*(n4-n5))*(n4-n5))/(c3^2*l3^2+(n4-n5)^2) 0 (c3^2*g*l3^2*m3*(-l3^2+(n4-n5)^2)+g*m3*(-(l3^2*(n4-n5)^2)+(n4-n5)^4)-4*c3*kw3*l3^3*(n4-n5)^2)/(c3*l3^3*(c3^2*l3^2+(n4-n5)^2)) 0 0 0 (d4*g*m3*(l3^2*(n4-n5)^2-(n4-n5)^4)+c3^3*g*l3^3*m3*(n4-n5)*n5+c3*l3*(n4-n5)^2*(4*d4*kw3*l3^2+g*m3*(n4-n5)*n5)+c3^2*(d4*g*l3^2*m3*(l3^2-(n4-n5)^2)+4*kw3*l3^4*n5*(-n4+n5)))/(c3*l3^3*(c3^2*l3^2+(n4-n5)^2))
 0 0 ((-1+c2^2)*g*(m2+m3))/(c2*l2)-(4*c2^2*kw2*l2^2)/(c2^2*l2^2+(n2-n3)^2) 0 0 0 0 0 (g*(m2+m3))/(c2*l2)-(c2*g*(m2+m3))/l2+(g*(m3-c3^2*m3))/(c3*l3)+(4*c2^2*kw2*l2^2)/(c2^2*l2^2+(n2-n3)^2)+(4*c3^2*kw3*l3^2)/(c3^2*l3^2+(n4-n5)^2) 0 0 0 0 0 ((-1+c3^2)*g*m3)/(c3*l3)-(4*c3^2*kw3*l3^2)/(c3^2*l3^2+(n4-n5)^2) 0 0 0
 0 0 0 (g*(m2+m3)*(n2-n3)^2*si^2)/(c2*l2^3)-(4*kw2*(n2-n3)^2*si^2)/(c2^2*l2^2+(n2-n3)^2)-(g*(m2+m3)*(n2*n3+si^2))/(c2*l2) 0 0 0 0 0 -((g*(m2+m3)*(n2-n3)^2*si^2)/(c2*l2^3))+(4*kw2*(n2-n3)^2*si^2)/(c2^2*l2^2+(n2-n3)^2)+(g*(m2+m3)*(n2*n3+si^2))/(c2*l2)-(g*m3*(n4-n5)^2*sl^2)/(c3*l3^3)+(4*kw3*(n4-n5)^2*sl^2)/(c3^2*l3^2+(n4-n5)^2)+(g*m3*(n4*n5+sl^2))/(c3*l3) 0 0 0 0 0 (-4*c3*kw3*l3^3*(n4-n5)^2*sl^2+c3^2*g*l3^2*m3*((n4-n5)^2*sl^2-l3^2*(n4*n5+sl^2))+g*m3*(n4-n5)^2*((n4-n5)^2*sl^2-l3^2*(n4*n5+sl^2)))/(c3*l3^3*(c3^2*l3^2+(n4-n5)^2)) 0 0
 -((d2*g*(m2+m3))/(c2*l2)) 0 0 0 (d1*d2*g*(m2+m3)+((-1+c2^2)*g*(m2+m3)-(4*c2^3*kw2*l2^3)/(c2^2*l2^2+(n2-n3)^2))*si^2)/(c2*l2) 0 -((d3*g*m3)/(c3*l3))+(d2*g*(m2+m3))/(c2*l2) 0 0 0 -((c2*g*(m2+m3)*si^2)/l2)+(4*c2^2*kw2*l2^2*si^2)/(c2^2*l2^2+(n2-n3)^2)+(g*(m2+m3)*(d2^2+c2*d2*l2+si^2))/(c2*l2)-(c3*g*m3*sl^2)/l3+(4*c3^2*kw3*l3^2*sl^2)/(c3^2*l3^2+(n4-n5)^2)+(g*m3*(d3^2+c3*d3*l3+sl^2))/(c3*l3) 0 (d3*g*m3)/(c3*l3) 0 0 0 (d3*d4*g*m3+((-1+c3^2)*g*m3-(4*c3^3*kw3*l3^3)/(c3^2*l3^2+(n4-n5)^2))*sl^2)/(c3*l3) 0
 0 (d2*g*(m2+m3))/(c2*l2)+(g*(m2+m3)*(n2-n3)*(c2*l2*n3+d2*(-n2+n3)))/(c2*l2^3)-(4*kw2*(n2-n3)*(c2*l2*n3+d2*(-n2+n3)))/(c2^2*l2^2+(n2-n3)^2) 0 0 0 (g*(m2+m3)*(d1*d2-n2*n3))/(c2*l2)+(g*(m2+m3)*(c2*l2*n2+d1*(n2-n3))*(c2*l2*n3+d2*(-n2+n3)))/(c2*l2^3)-(4*kw2*(c2*l2*n2+d1*(n2-n3))*(c2*l2*n3+d2*(-n2+n3)))/(c2^2*l2^2+(n2-n3)^2) 0 (d3*g*m3)/(c3*l3)-(d2*g*(m2+m3))/(c2*l2)-(g*(m2+m3)*(n2-n3)*(c2*l2*n3+d2*(-n2+n3)))/(c2*l2^3)+(4*kw2*(n2-n3)*(c2*l2*n3+d2*(-n2+n3)))/(c2^2*l2^2+(n2-n3)^2)-(g*m3*(c3*l3*n4+d3*(n4-n5))*(n4-n5))/(c3*l3^3)+(4*kw3*(c3*l3*n4+d3*(n4-n5))*(n4-n5))/(c3^2*l3^2+(n4-n5)^2) 0 0 0 (g*(m2+m3)*(d2^2+c2*d2*l2+n2*n3))/(c2*l2)-(g*(m2+m3)*(c2*l2*n3+d2*(-n2+n3))^2)/(c2*l2^3)+(4*kw2*(c2*l2*n3+d2*(-n2+n3))^2)/(c2^2*l2^2+(n2-n3)^2)-(g*m3*(c3*l3*n4+d3*(n4-n5))^2)/(c3*l3^3)+(4*kw3*(c3*l3*n4+d3*(n4-n5))^2)/(c3^2*l3^2+(n4-n5)^2)+(g*m3*(d3^2+c3*d3*l3+n4*n5))/(c3*l3) 0 (d3*g*m3*(-(l3^2*(n4-n5)^2)+(n4-n5)^4)+c3^3*g*l3^3*m3*n4*(n4-n5)+c3*l3*(-4*d3*kw3*l3^2+g*m3*n4*(n4-n5))*(n4-n5)^2+c3^2*(d3*g*l3^2*m3*(-l3^2+(n4-n5)^2)+4*kw3*l3^4*n4*(-n4+n5)))/(c3*l3^3*(c3^2*l3^2+(n4-n5)^2)) 0 0 0 (g*m3*(d3*d4-n4*n5))/(c3*l3)+(g*m3*(c3*l3*n4+d3*(n4-n5))*(c3*l3*n5+d4*(-n4+n5)))/(c3*l3^3)-(4*kw3*(c3*l3*n4+d3*(n4-n5))*(c3*l3*n5+d4*(-n4+n5)))/(c3^2*l3^2+(n4-n5)^2)
 0 0 0 0 0 0 -((g*m3)/(c3*l3)) 0 0 0 (d3*g*m3)/(c3*l3) 0 (g*m3)/(c3*l3) 0 0 0 (d4*g*m3)/(c3*l3) 0
 0 0 0 0 0 0 0 (c3^2*g*l3^2*m3*(-l3^2+(n4-n5)^2)+g*m3*(-(l3^2*(n4-n5)^2)+(n4-n5)^4)-4*c3*kw3*l3^3*(n4-n5)^2)/(c3*l3^3*(c3^2*l3^2+(n4-n5)^2)) 0 0 0 (d3*g*m3*(-(l3^2*(n4-n5)^2)+(n4-n5)^4)+c3^3*g*l3^3*m3*n4*(n4-n5)+c3*l3*(-4*d3*kw3*l3^2+g*m3*n4*(n4-n5))*(n4-n5)^2+c3^2*(d3*g*l3^2*m3*(-l3^2+(n4-n5)^2)+4*kw3*l3^4*n4*(-n4+n5)))/(c3*l3^3*(c3^2*l3^2+(n4-n5)^2)) 0 (c3^2*g*l3^2*m3*(l3^2-(n4-n5)^2)+g*m3*(l3^2*(n4-n5)^2-(n4-n5)^4)+4*c3*kw3*l3^3*(n4-n5)^2)/(c3*l3^3*(c3^2*l3^2+(n4-n5)^2)) 0 0 0 (d4*g*m3*(-(l3^2*(n4-n5)^2)+(n4-n5)^4)+c3^3*g*l3^3*m3*n5*(-n4+n5)+c3^2*(d4*g*l3^2*m3*(-l3^2+(n4-n5)^2)+4*kw3*l3^4*(n4-n5)*n5)-c3*l3*(n4-n5)^2*(4*d4*kw3*l3^2+g*m3*(n4-n5)*n5))/(c3*l3^3*(c3^2*l3^2+(n4-n5)^2))
 0 0 0 0 0 0 0 0 ((-1+c3^2)*g*m3)/(c3*l3)-(4*c3^2*kw3*l3^2)/(c3^2*l3^2+(n4-n5)^2) 0 0 0 0 0 (g*(m3-c3^2*m3))/(c3*l3)+(4*c3^2*kw3*l3^2)/(c3^2*l3^2+(n4-n5)^2) 0 0 0
 0 0 0 0 0 0 0 0 0 (-4*c3*kw3*l3^3*(n4-n5)^2*sl^2+c3^2*g*l3^2*m3*((n4-n5)^2*sl^2-l3^2*(n4*n5+sl^2))+g*m3*(n4-n5)^2*((n4-n5)^2*sl^2-l3^2*(n4*n5+sl^2)))/(c3*l3^3*(c3^2*l3^2+(n4-n5)^2)) 0 0 0 0 0 (4*c3*kw3*l3^3*(n4-n5)^2*sl^2+c3^2*g*l3^2*m3*(-((n4-n5)^2*sl^2)+l3^2*(n4*n5+sl^2))+g*m3*(-((n4-n5)^4*sl^2)+l3^2*(n4-n5)^2*(n4*n5+sl^2)))/(c3*l3^3*(c3^2*l3^2+(n4-n5)^2)) 0 0
 0 0 0 0 0 0 -((d4*g*m3)/(c3*l3)) 0 0 0 (d3*d4*g*m3+((-1+c3^2)*g*m3-(4*c3^3*kw3*l3^3)/(c3^2*l3^2+(n4-n5)^2))*sl^2)/(c3*l3) 0 (d4*g*m3)/(c3*l3) 0 0 0 (d4^2*g*m3+c3*d4*g*l3*m3+(g*(m3-c3^2*m3)+(4*c3^3*kw3*l3^3)/(c3^2*l3^2+(n4-n5)^2))*sl^2)/(c3*l3) 0
 0 0 0 0 0 0 0 (d4*g*m3*(l3^2*(n4-n5)^2-(n4-n5)^4)+c3^3*g*l3^3*m3*(n4-n5)*n5+c3*l3*(n4-n5)^2*(4*d4*kw3*l3^2+g*m3*(n4-n5)*n5)+c3^2*(d4*g*l3^2*m3*(l3^2-(n4-n5)^2)+4*kw3*l3^4*n5*(-n4+n5)))/(c3*l3^3*(c3^2*l3^2+(n4-n5)^2)) 0 0 0 (g*m3*(d3*d4-n4*n5))/(c3*l3)+(g*m3*(c3*l3*n4+d3*(n4-n5))*(c3*l3*n5+d4*(-n4+n5)))/(c3*l3^3)-(4*kw3*(c3*l3*n4+d3*(n4-n5))*(c3*l3*n5+d4*(-n4+n5)))/(c3^2*l3^2+(n4-n5)^2) 0 (d4*g*m3*(-(l3^2*(n4-n5)^2)+(n4-n5)^4)+c3^3*g*l3^3*m3*n5*(-n4+n5)+c3^2*(d4*g*l3^2*m3*(-l3^2+(n4-n5)^2)+4*kw3*l3^4*(n4-n5)*n5)-c3*l3*(n4-n5)^2*(4*d4*kw3*l3^2+g*m3*(n4-n5)*n5))/(c3*l3^3*(c3^2*l3^2+(n4-n5)^2)) 0 0 0 d4*g*m3+(d4^2*g*m3)/(c3*l3)+(g*m3*(n4-n5)*n5)/(2*c3*l3)+(g*m3*n5^2)/(c3*l3)-(g*m3*n5*(-n4+n5))/(2*c3*l3)-(g*m3*(c3*l3*n5+d4*(-n4+n5))^2)/(c3*l3^3)+(4*kw3*(c3*l3*n5+d4*(-n4+n5))^2)/(c3^2*l3^2+(n4-n5)^2)
];
km = [...
m1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 m1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 m1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 I1z I1yz I1zx 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 I1yz I1y I1xy 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 I1zx I1xy I1x 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 m2 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 m2 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 m2 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 I2z I2yz I2zx 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 I2yz I2y I2xy 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 I2zx I2xy I2x 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 m3 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 m3 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 m3 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 I3z I3yz I3zx
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 I3yz I3y I3xy
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 I3zx I3xy I3x
];
cqxm = [...
0 ((-(g*(m1+m2+m3))+(2*c1*kw1*l1^3)/(c1^2*l1^2+(n0-n1)^2))*(-n0+n1))/(2*l1^2) ((-1+c1^2)*g*(m1+m2+m3))/(2*c1*l1)-(c1^2*kw1*l1^2)/(c1^2*l1^2+(n0-n1)^2) 0 0 ((-2*g*l1*(m1+m2+m3)*n1)/c1+2*g*(m1+m2+m3)*(c1*l1*n1+d0*(-n0+n1))-(4*c1*kw1*l1^3*(c1*l1*n1+d0*(-n0+n1)))/(c1^2*l1^2+(n0-n1)^2))/(4*l1^2) 0 0 0 0 0 0 0 0 0 0 0 0
 0 ((-(g*(m1+m2+m3))+(2*c1*kw1*l1^3)/(c1^2*l1^2+(n0-n1)^2))*(n0-n1))/(2*l1^2) ((-1+c1^2)*g*(m1+m2+m3))/(2*c1*l1)-(c1^2*kw1*l1^2)/(c1^2*l1^2+(n0-n1)^2) 0 0 ((2*g*l1*(m1+m2+m3)*n1)/c1+2*g*(m1+m2+m3)*(d0*(n0-n1)-c1*l1*n1)+(4*c1*kw1*l1^3*(c1*l1*n1+d0*(-n0+n1)))/(c1^2*l1^2+(n0-n1)^2))/(4*l1^2) 0 0 0 0 0 0 0 0 0 0 0 0
 0 ((g*(m2+m3)-(4*c2*kw2*l2^3)/(c2^2*l2^2+(n2-n3)^2))*(-n2+n3))/(4*l2^2) -1/4*((-1+c2^2)*g*(m2+m3))/(c2*l2)+(c2^2*kw2*l2^2)/(c2^2*l2^2+(n2-n3)^2) ((g*(m2+m3)-(4*c2*kw2*l2^3)/(c2^2*l2^2+(n2-n3)^2))*(-n2+n3)*si)/(4*l2^2) (((-1+c2^2)*g*(m2+m3)-(4*c2^3*kw2*l2^3)/(c2^2*l2^2+(n2-n3)^2))*si)/(4*c2*l2) (-2*g*(m2+m3)*(c2*l2*n2+d1*(n2-n3))+(8*c2*kw2*l2^3*(c2*l2*n2+d1*(n2-n3)))/(c2^2*l2^2+(n2-n3)^2)+(2*g*l2*(m2+m3)*n3)/c2)/(8*l2^2) 0 ((-(g*(m2+m3))+(4*c2*kw2*l2^3)/(c2^2*l2^2+(n2-n3)^2))*(-n2+n3))/(4*l2^2) ((-1+c2^2)*g*(m2+m3))/(4*c2*l2)-(c2^2*kw2*l2^2)/(c2^2*l2^2+(n2-n3)^2) ((-(g*(m2+m3))+(4*c2*kw2*l2^3)/(c2^2*l2^2+(n2-n3)^2))*(-n2+n3)*si)/(4*l2^2) -1/4*((-1+c2^2)*g*(m2+m3)*si)/(c2*l2)+(c2^2*kw2*l2^2*si)/(c2^2*l2^2+(n2-n3)^2) ((-2*g*l2*(m2+m3)*n3)/c2+2*g*(m2+m3)*(c2*l2*n3+d2*(-n2+n3))-(8*c2*kw2*l2^3*(c2*l2*n3+d2*(-n2+n3)))/(c2^2*l2^2+(n2-n3)^2))/(8*l2^2) 0 0 0 0 0 0
 0 ((g*(m2+m3)-(4*c2*kw2*l2^3)/(c2^2*l2^2+(n2-n3)^2))*(-n2+n3))/(4*l2^2) -1/4*((-1+c2^2)*g*(m2+m3))/(c2*l2)+(c2^2*kw2*l2^2)/(c2^2*l2^2+(n2-n3)^2) ((-(g*(m2+m3))+(4*c2*kw2*l2^3)/(c2^2*l2^2+(n2-n3)^2))*(-n2+n3)*si)/(4*l2^2) -1/4*((-1+c2^2)*g*(m2+m3)*si)/(c2*l2)+(c2^2*kw2*l2^2*si)/(c2^2*l2^2+(n2-n3)^2) (-2*g*(m2+m3)*(c2*l2*n2+d1*(n2-n3))+(8*c2*kw2*l2^3*(c2*l2*n2+d1*(n2-n3)))/(c2^2*l2^2+(n2-n3)^2)+(2*g*l2*(m2+m3)*n3)/c2)/(8*l2^2) 0 ((-(g*(m2+m3))+(4*c2*kw2*l2^3)/(c2^2*l2^2+(n2-n3)^2))*(-n2+n3))/(4*l2^2) ((-1+c2^2)*g*(m2+m3))/(4*c2*l2)-(c2^2*kw2*l2^2)/(c2^2*l2^2+(n2-n3)^2) ((g*(m2+m3)-(4*c2*kw2*l2^3)/(c2^2*l2^2+(n2-n3)^2))*(-n2+n3)*si)/(4*l2^2) (((-1+c2^2)*g*(m2+m3)-(4*c2^3*kw2*l2^3)/(c2^2*l2^2+(n2-n3)^2))*si)/(4*c2*l2) ((-2*g*l2*(m2+m3)*n3)/c2+2*g*(m2+m3)*(c2*l2*n3+d2*(-n2+n3))-(8*c2*kw2*l2^3*(c2*l2*n3+d2*(-n2+n3)))/(c2^2*l2^2+(n2-n3)^2))/(8*l2^2) 0 0 0 0 0 0
 0 ((g*(m2+m3)-(4*c2*kw2*l2^3)/(c2^2*l2^2+(n2-n3)^2))*(n2-n3))/(4*l2^2) -1/4*((-1+c2^2)*g*(m2+m3))/(c2*l2)+(c2^2*kw2*l2^2)/(c2^2*l2^2+(n2-n3)^2) ((g*(m2+m3)-(4*c2*kw2*l2^3)/(c2^2*l2^2+(n2-n3)^2))*(n2-n3)*si)/(4*l2^2) (((-1+c2^2)*g*(m2+m3)-(4*c2^3*kw2*l2^3)/(c2^2*l2^2+(n2-n3)^2))*si)/(4*c2*l2) (2*g*(m2+m3)*(c2*l2*n2+d1*(n2-n3))-(8*c2*kw2*l2^3*(c2*l2*n2+d1*(n2-n3)))/(c2^2*l2^2+(n2-n3)^2)-(2*g*l2*(m2+m3)*n3)/c2)/(8*l2^2) 0 ((-(g*(m2+m3))+(4*c2*kw2*l2^3)/(c2^2*l2^2+(n2-n3)^2))*(n2-n3))/(4*l2^2) ((-1+c2^2)*g*(m2+m3))/(4*c2*l2)-(c2^2*kw2*l2^2)/(c2^2*l2^2+(n2-n3)^2) ((-(g*(m2+m3))+(4*c2*kw2*l2^3)/(c2^2*l2^2+(n2-n3)^2))*(n2-n3)*si)/(4*l2^2) -1/4*((-1+c2^2)*g*(m2+m3)*si)/(c2*l2)+(c2^2*kw2*l2^2*si)/(c2^2*l2^2+(n2-n3)^2) ((2*g*l2*(m2+m3)*n3)/c2+2*g*(m2+m3)*(d2*(n2-n3)-c2*l2*n3)+(8*c2*kw2*l2^3*(c2*l2*n3+d2*(-n2+n3)))/(c2^2*l2^2+(n2-n3)^2))/(8*l2^2) 0 0 0 0 0 0
 0 ((g*(m2+m3)-(4*c2*kw2*l2^3)/(c2^2*l2^2+(n2-n3)^2))*(n2-n3))/(4*l2^2) -1/4*((-1+c2^2)*g*(m2+m3))/(c2*l2)+(c2^2*kw2*l2^2)/(c2^2*l2^2+(n2-n3)^2) ((-(g*(m2+m3))+(4*c2*kw2*l2^3)/(c2^2*l2^2+(n2-n3)^2))*(n2-n3)*si)/(4*l2^2) -1/4*((-1+c2^2)*g*(m2+m3)*si)/(c2*l2)+(c2^2*kw2*l2^2*si)/(c2^2*l2^2+(n2-n3)^2) (2*g*(m2+m3)*(c2*l2*n2+d1*(n2-n3))-(8*c2*kw2*l2^3*(c2*l2*n2+d1*(n2-n3)))/(c2^2*l2^2+(n2-n3)^2)-(2*g*l2*(m2+m3)*n3)/c2)/(8*l2^2) 0 ((-(g*(m2+m3))+(4*c2*kw2*l2^3)/(c2^2*l2^2+(n2-n3)^2))*(n2-n3))/(4*l2^2) ((-1+c2^2)*g*(m2+m3))/(4*c2*l2)-(c2^2*kw2*l2^2)/(c2^2*l2^2+(n2-n3)^2) ((g*(m2+m3)-(4*c2*kw2*l2^3)/(c2^2*l2^2+(n2-n3)^2))*(n2-n3)*si)/(4*l2^2) (((-1+c2^2)*g*(m2+m3)-(4*c2^3*kw2*l2^3)/(c2^2*l2^2+(n2-n3)^2))*si)/(4*c2*l2) ((2*g*l2*(m2+m3)*n3)/c2+2*g*(m2+m3)*(d2*(n2-n3)-c2*l2*n3)+(8*c2*kw2*l2^3*(c2*l2*n3+d2*(-n2+n3)))/(c2^2*l2^2+(n2-n3)^2))/(8*l2^2) 0 0 0 0 0 0
];
cxsm = [...
-((g*(m1+m2+m3))/(c1*l1)) 0 0 0 (dtop*g*(m1+m2+m3))/(c1*l1) 0
 0 -((g*(m1+m2+m3))/(c1*l1))+(g*(m1+m2+m3)*(n0-n1)^2)/(c1*l1^3)-(2*kw1*(n0-n1)^2)/(c1^2*l1^2+(n0-n1)^2) 0 0 0 -((dtop*g*(m1+m2+m3))/(c1*l1))+(g*(m1+m2+m3)*(c1*l1*n0+dtop*(n0-n1))*(n0-n1))/(c1*l1^3)-(2*kw1*(c1*l1*n0+dtop*(n0-n1))*(n0-n1))/(c1^2*l1^2+(n0-n1)^2)
 0 0 ((-1+c1^2)*g*(m1+m2+m3))/(c1*l1)-(2*c1^2*kw1*l1^2)/(c1^2*l1^2+(n0-n1)^2) 0 0 0
 0 0 0 -((g*(m1+m2+m3)*n0*n1)/(c1*l1)) 0 0
 -((d0*g*(m1+m2+m3))/(c1*l1)) 0 0 0 (d0*dtop*g*(m1+m2+m3))/(c1*l1) 0
 0 (d0*g*(m1+m2+m3))/(c1*l1)+(g*(m1+m2+m3)*(n0-n1)*(c1*l1*n1+d0*(-n0+n1)))/(c1*l1^3)-(2*kw1*(n0-n1)*(c1*l1*n1+d0*(-n0+n1)))/(c1^2*l1^2+(n0-n1)^2) 0 0 0 (g*(m1+m2+m3)*(d0*dtop-n0*n1))/(c1*l1)+(g*(m1+m2+m3)*(c1*l1*n0+dtop*(n0-n1))*(c1*l1*n1+d0*(-n0+n1)))/(c1*l1^3)-(2*kw1*(c1*l1*n0+dtop*(n0-n1))*(c1*l1*n1+d0*(-n0+n1)))/(c1^2*l1^2+(n0-n1)^2)
 0 0 0 0 0 0
 0 0 0 0 0 0
 0 0 0 0 0 0
 0 0 0 0 0 0
 0 0 0 0 0 0
 0 0 0 0 0 0
 0 0 0 0 0 0
 0 0 0 0 0 0
 0 0 0 0 0 0
 0 0 0 0 0 0
 0 0 0 0 0 0
 0 0 0 0 0 0
];
